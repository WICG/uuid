<!DOCTYPE html>
<html lang="en">
  <head>
<meta charset="utf-8">
    <title>
      uuid
    </title>
    <script src="https://www.w3.org/Tools/respec/respec-w3c" class=
    "remove"></script>
    <script class='remove'>
    "use strict";
    // See https://github.com/w3c/respec/wiki/ for how to configure ReSpec
    var respecConfig = {
      "github": "WICG/uuid",
      "editors": [{
          name: "Ben Coe",
          email: "bencoe@google.com",
          company: "Google",
          companyURL: "https://google.com",
        },
        // Add additional editors here.
        // https://github.com/w3c/respec/wiki/editors
        {
          name: "Robert Kieffer",
          email: "robert@broofa.com",
        },
        {
          name: "Christoph Tavan",
          email: "ctavan@google.com",
          company: "Google",
          companyURL: "https://google.com",
        }
      ],
      "shortName": "uuid",
      "specStatus": "CG-DRAFT",
      "group": "wicg",
      "xref": "web-platform",
    };
    </script>
  </head>
  <body data-cite="webcryptoapi">
    <section id="abstract">
      <p>
        This specification describes an API for generating character encoded
        Universally Unique Identifiers (UUID) based on [[RFC4122]], available
        as a method on the {{Crypto}} interface.
      </p>
    </section>
    <section id='sotd'>
      <p>
        This is a work in progress.
      </p>
    </section>
    <section>
      <h2>
        Usage Example
      </h2>
      <p>
        To generate a UUID, simply call {{Crypto}}'s {{Crypto/randomUUID()}}
        method:
      </p>
      <pre class="example js" title="Generate unique name for download">
        const filename = `${crypto.randomUUID()}.txt`;
        // do something with filename.
      </pre>
    </section>
    <section data-dfn-for="Crypto">
      <h2>
        Extensions to the `Crypto` interface
      </h2>
      <pre class="idl">
        [Exposed=(Window,Worker)]
        partial interface Crypto {
          [SecureContext] DOMString randomUUID();
        };
      </pre>
      <aside class="note">
        <p>
          {{Crypto/randomUUID()}} generates a new <a data-cite=
          "RFC4122#section-4.4">version 4 UUID</a> and returns its
          <a data-cite="RFC2141#section-2.2">namespace specific string
          representation</a> as described in <a data-cite=
          "RFC4122#section-3">section 3</a> of [[RFC4122]].
        </p>
      </aside>
      <section>
        <h3>
          The `randomUUID()` method
        </h3>
        <p>
          The <dfn>randomUUID()</dfn> method steps are to return the result of
          [=generating a random UUID=].
        </p>
      </section>
    </section>
    <section>
      <h2>
        Generating a random UUID
      </h2>
      <p>
        To <dfn data-local-lt="generating a random UUID" data-export=
        "">generate a random UUID</dfn>:
      </p>
      <ol>
        <li>Let |array| be a [=list=] with 16 elements of the type [=byte=].
        </li>
        <li>Overwrite all elements of |array| with cryptographically secure
        random values of the type [=byte=].
        </li>
        <li>Set the 4 most significant bits of |array|[6], which represent the
        UUID <a data-cite="RFC4122#section-4.1.3">version</a>, to `0b0100`.
        </li>
        <li>Set the 2 most significant bits of |array|[8], which represent the
        UUID <a data-cite="RFC4122#section-4.1.1">variant</a>, to `0b10`.
        </li>
        <li>
          <p>
            Return the [=string/concatenate|concatenation=] of «
          </p>
          <ol style="list-style-type: none">
            <li>[=hexadecimal representation=] of |array|[0], [=hexadecimal
            representation=] of |array|[1], [=hexadecimal representation=] of
            |array|[2], [=hexadecimal representation=] of |array|[3],
            </li>
            <li>`"-"`,
            </li>
            <li>[=hexadecimal representation=] of |array|[4], [=hexadecimal
            representation=] of |array|[5],
            </li>
            <li>`"-"`,
            </li>
            <li>[=hexadecimal representation=] of |array|[6], [=hexadecimal
            representation=] of |array|[7],
            </li>
            <li>`"-"`,
            </li>
            <li>[=hexadecimal representation=] of |array|[8], [=hexadecimal
            representation=] of |array|[9],
            </li>
            <li>`"-"`,
            </li>
            <li>[=hexadecimal representation=] of |array|[10], [=hexadecimal
            representation=] of |array|[11], [=hexadecimal representation=] of
            |array|[12], [=hexadecimal representation=] of |array|[13],
            [=hexadecimal representation=] of |array|[14], [=hexadecimal
            representation=] of |array|[15]
            </li>
          </ol>
          <p>
            ».
          </p>
        </li>
      </ol>
      <p>
        For the steps described in the [=generate a random UUID=] algorithm,
        the <dfn>hexadecimal representation</dfn> of a [=byte=] |value| is the
        two-character string created by expressing |value| in hexadecimal using
        [=ASCII lower hex digits=], left-padded with `"0"` to reach two
        [=characters=].
      </p>
    </section>
    <section id="security" class="informative">
      <h2>
        Security considerations
      </h2>
      <dl>
        <dt>
          Denial of service
        </dt>
        <dd>
          Generating random values has the potential to perform computationally
          expensive and/or blocking work (<em>if there is not enough entropy
          available in the system</em>). As such, hostile applications may
          attempt to misuse this API and attempt to cause significant amount of
          work to be performed by an implementation, denying access or services
          to other applications that are executing. In practice, these concerns
          can be mitigated by using non-blocking sources of randomness, e.g.,
          "/dev/urandom". See also, <dfn data-cite=
          "WebCryptoAPI/#security-considerations">WebCrypto Security
          Considerations</dfn>.
        </dd>
        <dt>
          Insufficient entropy
        </dt>
        <dd>
          If {{Crypto/randomUUID()}} is invoked before the underlying system is
          seeded with enough entropy it may result in colliding UUIDs (due to
          cycles in the PRNG). Authors of applications that use
          {{Crypto/randomUUID}} need to be aware of these risks.
        </dd>
      </dl>
    </section>
    <section id="privacy" class="informative">
      <h2>
        Privacy considerations
      </h2>
      <dl>
        <dt>
          Fingerprinting
        </dt>
        <dd>
          By exposing additional APIs that reflect capabilities of the
          underlying platform, this specification may allow malicious
          applications to determine or distinguish different user agents or
          devices. One such approach is outlined in <a href=
          "https://www.youtube.com/watch?v=5sZT9FTx3aQ">Clock Around the Clock:
          Time-Based Device Fingerprinting</a> which discusses creating a
          fingerprint based on a PRNG in JavaScript. {{Crypto/randomUUID}} is
          not likely to make users more susceptible to fingerprinting than they
          are through existing cryptography methods. See also, <dfn data-cite=
          "WebCryptoAPI/#privacy">WebCrypto Privacy Considerations</dfn>.
        </dd>
        <dt>
          Use of {{Crypto/randomUUID}} as user ID
        </dt>
        <dd>
          {{Crypto/randomUUID}} is useful for generating <a href=
          "https://w3cping.github.io/privacy-threat-model/#user-id">user
          IDs</a>, but does not directly give any ability to generate <a href=
          "https://w3cping.github.io/privacy-threat-model/#global-identifier">global
          identifiers</a>.
        </dd>
      </dl>
    </section>
    <section id="conformance"></section>
  </body>
</html>
